<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Writing a python package with Hatch and pyOpenSci | Collin J. Schwantes </title> <meta name="author" content="Collin J. Schwantes"> <meta name="description" content="Notes on writing a python package"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <meta property="og:site_name" content="Collin J. Schwantes"> <meta property="og:type" content="article"> <meta property="og:title" content="Collin J. Schwantes | Writing a python package with Hatch and pyOpenSci"> <meta property="og:url" content="https://collinschwantes.github.io/blog/2025/pypackage/"> <meta property="og:description" content="Notes on writing a python package"> <meta property="og:locale" content="en"> <meta name="twitter:card" content="summary"> <meta name="twitter:title" content="Writing a python package with Hatch and pyOpenSci"> <meta name="twitter:description" content="Notes on writing a python package"> <script type="application/ld+json">
    {
        "author":
        {
            "@type": "Person",
            "name": "Collin J. Schwantes"
        },
        "url": "https://collinschwantes.github.io/blog/2025/pypackage/",
        "@type": "BlogPosting",
        "description": "Notes on writing a python package",
        "headline": "Writing a python package with Hatch and pyOpenSci",
        
        "sameAs": ["https://orcid.org/0000-0002-9882-941X", "https://osf.io/a752m/", "https://github.com/collinschwantes", "https://fosstodon.org/@collinschwantes", "https://www.zotero.org/cschwantes"],
        
        "name": "Collin J. Schwantes",
        "@context": "https://schema.org"
    }
  </script> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/cjs.svg?c95653ea8ad807f15cbf38ec20d20f68"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://collinschwantes.github.io/blog/2025/pypackage/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Collin</span> J. Schwantes </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Writing a python package with Hatch and pyOpenSci</h1> <p class="post-meta"> Created in March 13, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/reproducibility"> <i class="fa-solid fa-hashtag fa-sm"></i> reproducibility</a>   <a href="/blog/tag/python"> <i class="fa-solid fa-hashtag fa-sm"></i> python</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>I recently published a new R package called <a href="https://github.com/viralemergence/virionData" rel="external nofollow noopener" target="_blank"><code class="language-plaintext highlighter-rouge">virionData</code></a>. It is essentially a wrapper for the Zenodo api and is designed to 1) provide access to the virion data stored on zenodo and 2) make it easier to track the version of the virion data one is using. After announcing the publication of the R package, a colleague almost immediately asked for a python version. Fair, why should they have to install R a dependency in their pipeline just to get the data?</p> <p>So now I am setting out to write a python package using Hatch and guidance from <a href="https://www.pyopensci.org/python-package-guide/tutorials/get-to-know-hatch.html#" rel="external nofollow noopener" target="_blank">pyOpenSci</a>.</p> <p>First impressions:</p> <p>In R, we can use <code class="language-plaintext highlighter-rouge">devtools</code>, <code class="language-plaintext highlighter-rouge">testthat</code>, and <code class="language-plaintext highlighter-rouge">usethis</code> to develop a fairly robust package. Granted those three packages load a host of others, the python package development ecosystem seems much less consolidated.</p> <p>I almost immediately ran into an issue with hatch. I wanted to call my package pyVirionData and that meant that my top level directory and the package directory in source had the same name. This caused some regex functions in hatch to fail when attempting to build the package. I may have also run an unnecessary <code class="language-plaintext highlighter-rouge">hatch init</code> call. So I started over and changed the name of the package to py-virion-data, the sub directory became py_virion_data and everything works as expected.</p> <p>As someone who primarialy programs in R, I’m a little nervous about publishing python code. I have developed a strong muscle memory for functional programming and will likley write code in that flavor (as opposed to more object oriented paradigms).</p> <p>After the initial hiccup with the package name, the tutorials seems to be running smoothly.</p> <h3 id="writing-python-code---youre-about-enter-a-stream-of-conciousness-section">Writing python code - you’re about enter a stream of conciousness section</h3> <p>Using vscode the docString extension is really helpful.</p> <p>Having to think in terms of classes makes me more economical.</p> <p>Oh yeah, you have to import functions between files, its not all just global like in R.</p> <p>python does a good job with json out of the box. this is nice.</p> <p>File paths are a mess. thank the gods for r’s FS package.</p> <p>The pythonFileSystem docs are confusing. There are functions for fs.path.BLAH and there are functions for different types of file systems.</p> <p>All file systems have api calls listed here: https://pyfilesystem2.readthedocs.io/en/latest/interface.html</p> <p>these are called with something like</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from fs.osfs import OSFS
 
fs_home = OSFS.home(".")
fs_home.makedir("hello") # makes a directory relative to working directory

</code></pre></div></div> <p>fs itself has classes and methods.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import fs
helloworld_path = fs.paths.join("hello","world")
</code></pre></div></div> <p>we can use them together with something like</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import fs
from fs.osfs import OSFS
fs_home = OSFS.home(".")
fs_home.makedir("hello")

helloworld_path = fs.paths.join("hello","world")
# note that makedir doesnt make directories recursively.
# there are functions in fs to build up components of a path
# and I am sure they would be useful for creating recursive
# directories
fs_home.makedir(helloworld_path)
</code></pre></div></div> <p>For loops on items are awesome.</p> <h3 id="merge-pull-requests">merge pull requests</h3> <p>I have gotten into the habit of splitting R functions into their own files. When adjudicating a PR, I check that each file/function meets my criteria for documentation and clarity. Each correction I make is reflected in only that file so I can use the “viewed” feature in github to great effect. With a monolith file that defines a class and its methods, I have to carefully check each section. While polishing up documentation and refining methods, the monolith file is changed, so I have to be extra vigilent about where I made changes. This is probably a function of not using subclasses/inheritance properly - though as of this writing the class definition is only ~350 lines.</p> <h3 id="publishing-workflow">publishing workflow</h3> <p>pypi using hatch</p> <p>1) <code class="language-plaintext highlighter-rouge">hatch version</code> 2) <code class="language-plaintext highlighter-rouge">hatch build</code> 3) <code class="language-plaintext highlighter-rouge">hatch publish -r # main or test </code></p> <p>grayskull for conda forge - to do</p> <p>read the docs - to do - this is a little less straightfoward than using <code class="language-plaintext highlighter-rouge">pkgdown</code> in R to build nice docs for your package.</p> <h2 id="conclusion">Conclusion</h2> <p>In general the system for publishing a python package is really straight foward. The PyOpenSci tutorial made the process very smooth. I think that since I had already written the R package and knew what functionality I wanted, it was easier to focus on building the python library. I would definitely recommend this order of operations for anyone coming from R to python because it allows you to focus on the python syntax and structure. Writing out the classes in python made me realize there is a lot of bloat in my R package and gave me ideas about how I could refactor to be more efficient.</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/cloud-native-gis/">Course on Cloud Native GIS</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/rix/">Rix with Bruno Rodrigues</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/zero-shot-data-integration/">Zero Shot Data Integration</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/deposits-in-the-wild/">Deposits in the Wild</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Collin J. Schwantes. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: December 02, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/mermaid@10.7.0/dist/mermaid.min.js" integrity="sha256-TtLOdUA8mstPoO6sGvHIGx2ceXrrX4KgIItO06XOn8A=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/d3@7.8.5/dist/d3.min.js" integrity="sha256-1rA678n2xEx7x4cTZ5x4wpUCj6kUMZEZ5cxLSVSFWxw=" crossorigin="anonymous"></script> <script>let mermaidTheme=determineComputedTheme();document.addEventListener("readystatechange",()=>{"complete"===document.readyState&&(document.querySelectorAll("pre>code.language-mermaid").forEach(e=>{const t=e.textContent,d=e.parentElement;d.classList.add("unloaded");let a=document.createElement("pre");a.classList.add("mermaid");const n=document.createTextNode(t);a.appendChild(n),d.after(a)}),mermaid.initialize({theme:mermaidTheme}),"undefined"!=typeof d3&&window.addEventListener("load",function(){d3.selectAll(".mermaid svg").each(function(){var e=d3.select(this);e.html("<g>"+e.html()+"</g>");var t=e.select("g"),d=d3.zoom().on("zoom",function(e){t.attr("transform",e.transform)});e.call(d)})}))});</script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script type="module" src="/assets/js/search/ninja-keys.min.js?601a2d3465e2a52bec38b600518d5f70"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script>let searchTheme=determineComputedTheme();const ninjaKeys=document.querySelector("ninja-keys");"dark"===searchTheme?ninjaKeys.classList.add("dark"):ninjaKeys.classList.remove("dark");const openSearchModal=()=>{const e=$("#navbarNav");e.hasClass("show")&&e.collapse("hide"),ninjaKeys.open()};</script> <script>const ninja=document.querySelector("ninja-keys");ninja.data=[{id:"nav-about",title:"about",section:"Navigation",handler:()=>{window.location.href="/"}},{id:"nav-blog",title:"blog",description:"",section:"Navigation",handler:()=>{window.location.href="/blog/"}},{id:"nav-publications",title:"publications",description:"publications by categories in reversed chronological order. generated by jekyll-scholar.",section:"Navigation",handler:()=>{window.location.href="/publications/"}},{id:"nav-projects",title:"projects",description:"A growing collection of your cool projects.",section:"Navigation",handler:()=>{window.location.href="/projects/"}},{id:"nav-repositories",title:"repositories",description:"Overview of github activity",section:"Navigation",handler:()=>{window.location.href="/repositories/"}},{id:"nav-cv",title:"cv",description:"This is a description of the page. You can modify it in '_pages/cv.md'. You can also change or remove the top pdf download button.",section:"Navigation",handler:()=>{window.location.href="/cv/"}},{id:"post-course-on-cloud-native-gis",title:"Course on Cloud Native GIS",description:"Notes on cloud native gis",section:"Posts",handler:()=>{window.location.href="/blog/2025/cloud-native-gis/"}},{id:"post-writing-a-python-package-with-hatch-and-pyopensci",title:"Writing a python package with Hatch and pyOpenSci",description:"Notes on writing a python package",section:"Posts",handler:()=>{window.location.href="/blog/2025/pypackage/"}},{id:"post-rix-with-bruno-rodrigues",title:"Rix with Bruno Rodrigues",description:"Notes on R package Rix",section:"Posts",handler:()=>{window.location.href="/blog/2025/rix/"}},{id:"post-zero-shot-data-integration",title:"Zero Shot Data Integration",description:"A blog post about integrating data sight unseen",section:"Posts",handler:()=>{window.location.href="/blog/2024/zero-shot-data-integration/"}},{id:"post-deposits-in-the-wild",title:"Deposits in the Wild",description:"A blog post about using the R package deposits",section:"Posts",handler:()=>{window.location.href="/blog/2024/deposits-in-the-wild/"}},{id:"news-a-simple-inline-announcement",title:"A simple inline announcement.",description:"",section:"News"},{id:"news-a-long-announcement-with-details",title:"A long announcement with details",description:"",section:"News",handler:()=>{window.location.href="/news/announcement_2/"}},{id:"news-a-simple-inline-announcement-with-markdown-emoji-sparkles-smile",title:'A simple inline announcement with Markdown emoji! <img class="emoji" title=":sparkles:" alt=":sparkles:" src="https://github.githubassets.com/images/icons/emoji/unicode/2728.png" height="20" width="20"> <img class="emoji" title=":smile:" alt=":smile:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png" height="20" width="20">',description:"",section:"News"},{id:"projects-aperol-r-package",title:"Aperol R package",description:"A fun package in R that gives you praise when you most need it",section:"Projects",handler:()=>{window.location.href="/projects/aperol/"}},{id:"projects-working-group-on-nih-dmsp-guidance",title:"Working Group on NIH DMSP Guidance",description:"OSF project page for NIH DMSP WG Guidance",section:"Projects",handler:()=>{window.location.href="/projects/nih_dmsp_wg/"}},{id:"projects-panama-ultra-trail-marathon",title:"Panama Ultra Trail Marathon",description:"I've never cried tears of joy after finishing a run - I did this time.",section:"Projects",handler:()=>{window.location.href="/projects/panama_ultra_marathon/"}},{id:"socials-email",title:"Send email",section:"Socials",handler:()=>{window.open("mailto:%63%6A%73%63%68%77%61%6E%74%65%73%4C%4C@%67%6D%61%69%6C.%63%6F%6D","_blank")}},{id:"socials-orcid",title:"ORCID",section:"Socials",handler:()=>{window.open("https://orcid.org/0000-0002-9882-941X","_blank")}},{id:"socials-open-science-framework",title:"Open Science Framework",section:"Socials",handler:()=>{window.open("https://osf.io/a752m/","_blank")}},{id:"socials-github",title:"GitHub",section:"Socials",handler:()=>{window.open("https://github.com/collinschwantes","_blank")}},{id:"socials-mastodon",title:"Mastodon",section:"Socials",handler:()=>{window.open("https://fosstodon.org/@collinschwantes","_blank")}},{id:"socials-zotero",title:"Zotero",section:"Socials",handler:()=>{window.open("https://www.zotero.org/cschwantes","_blank")}},{id:"socials-rss",title:"RSS Feed",section:"Socials",handler:()=>{window.open("/feed.xml","_blank")}},{id:"light-theme",title:"Change theme to light",description:"Change the theme of the site to Light",section:"Theme",handler:()=>{setThemeSetting("light")}},{id:"dark-theme",title:"Change theme to dark",description:"Change the theme of the site to Dark",section:"Theme",handler:()=>{setThemeSetting("dark")}},{id:"system-theme",title:"Use system default theme",description:"Change the theme of the site to System Default",section:"Theme",handler:()=>{setThemeSetting("system")}}];</script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>